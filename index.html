<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Phoenix Automobile — Estimation</title>

  <!-- Police propre -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --navy:#0b1f3b;        /* bleu marine */
      --navy2:#0f2d55;
      --orange:#f28a2a;      /* orange phoenix */
      --bg:#071426;
      --card:#0c1f3a;
      --text:#eaf0ff;
      --muted:#b7c3df;
      --line:rgba(255,255,255,.10);
      --ok:#22c55e;
      --shadow: 0 18px 45px rgba(0,0,0,.45);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Montserrat,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background: radial-gradient(1200px 800px at 30% -10%, rgba(242,138,42,.25), transparent 60%),
                  radial-gradient(900px 600px at 90% 10%, rgba(20,90,200,.20), transparent 55%),
                  linear-gradient(180deg, var(--bg), #050c16 70%);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:1040px;margin:0 auto;padding:42px 18px 80px}
    .topbar{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      padding:14px 16px;border:1px solid var(--line);border-radius:20px;
      background:rgba(11,31,59,.55);backdrop-filter: blur(10px);
    }
    .brand{
      display:flex;align-items:center;gap:12px;min-width:0;
    }
    .logo{
      width:44px;height:44px;border-radius:14px;
      background: radial-gradient(circle at 30% 30%, rgba(242,138,42,.85), rgba(242,138,42,.35) 55%, transparent 70%),
                  linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,0));
      border:1px solid rgba(255,255,255,.18);
      box-shadow: 0 10px 25px rgba(0,0,0,.35);
      display:grid;place-items:center;
      font-weight:800;letter-spacing:.5px;
    }
    .brand h1{margin:0;font-size:15px;letter-spacing:.22em;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .brand small{display:block;color:var(--muted);font-size:12px;letter-spacing:.02em}

    .ctaRow{display:flex;gap:10px;flex-wrap:wrap}
    .btn{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:12px 14px;border-radius:14px;
      font-weight:700;cursor:pointer;
      transition: transform .08s ease, background .12s ease, border-color .12s ease;
    }
    .btn:hover{transform:translateY(-1px);border-color:rgba(255,255,255,.22);background:rgba(255,255,255,.09)}
    .btn.primary{
      background:linear-gradient(135deg, var(--orange), #ffb25f);
      color:#1b1208;border:none;
    }
    .btn.primary:hover{filter:saturate(1.05) brightness(1.02)}
    .hero{
      margin-top:22px;
      display:grid;grid-template-columns: 1.05fr .95fr;gap:18px;
      align-items:stretch;
    }
    @media (max-width: 880px){ .hero{grid-template-columns:1fr} }

    .card{
      background:rgba(12,31,58,.62);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .heroLeft{padding:26px 24px}
    .kicker{color:var(--muted);font-weight:700;letter-spacing:.12em;text-transform:uppercase;font-size:12px}
    .headline{margin:10px 0 10px;font-size:40px;line-height:1.05;letter-spacing:-.02em}
    .headline span{color:#ffd5a6}
    .sub{color:var(--muted);max-width:52ch;line-height:1.55;margin:0 0 18px}
    .badges{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .badge{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:8px 10px;border-radius:999px;
      font-size:12px;font-weight:700;
    }

    .heroRight{padding:0}
    .panelHead{
      padding:18px 18px 14px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.07), transparent);
    }
    .panelTitle{margin:0;font-size:16px;font-weight:800;letter-spacing:.06em;text-transform:uppercase}
    .panelNote{margin:8px 0 0;color:var(--muted);font-size:13px;line-height:1.5}

    /* Form */
    .formWrap{padding:18px}
    .progress{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin-bottom:14px;
    }
    .bar{
      height:10px;border-radius:999px;flex:1;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
    }
    .bar > i{
      display:block;height:100%;
      width:0%;
      background:linear-gradient(90deg, var(--orange), #ffcf9c);
      border-radius:999px;
      transition: width .25s ease;
    }
    .stepText{font-weight:800;color:var(--muted);font-size:13px;white-space:nowrap}
    .stepText.ok{color:var(--ok)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width: 520px){ .grid{grid-template-columns:1fr} }

    label{display:block;font-size:12px;color:var(--muted);margin:0 0 6px;font-weight:700;letter-spacing:.02em}
    input, select, textarea{
      width:100%;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.22);
      color:var(--text);
      padding:12px 12px;
      outline:none;
      font-size:14px;
      transition: border-color .12s ease, background .12s ease;
    }
    input:focus, select:focus, textarea:focus{
      border-color: rgba(242,138,42,.65);
      background:rgba(0,0,0,.28);
    }
    textarea{min-height:88px;resize:vertical}
    .radioRow{display:flex;gap:10px;flex-wrap:wrap}
    .chip{
      display:flex;align-items:center;gap:10px;
      padding:12px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      cursor:pointer;user-select:none;
      flex:1;min-width:180px;
      font-weight:800;
    }
    .chip input{width:16px;height:16px}
    .chip.active{
      border-color: rgba(242,138,42,.6);
      background: rgba(242,138,42,.12);
    }

    .actions{
      display:flex;gap:10px;justify-content:space-between;align-items:center;
      margin-top:14px;
    }
    .actions .btn{min-width:120px}
    .muted{color:var(--muted);font-size:12px;line-height:1.5}
    .hide{display:none!important}

    /* Modal "Merci" */
    .modal{
      position:fixed;inset:0;
      background:rgba(0,0,0,.55);
      display:none;place-items:center;
      padding:18px;
    }
    .modal.open{display:grid}
    .modalCard{
      width:min(560px, 100%);
      border-radius:22px;
      background:rgba(12,31,58,.82);
      border:1px solid rgba(255,255,255,.16);
      box-shadow:var(--shadow);
      padding:18px;
    }
    .modalCard h3{margin:0 0 6px;font-size:18px}
    .okLine{display:flex;align-items:center;gap:10px;color:var(--ok);font-weight:800;margin:10px 0 0}
    .okDot{width:10px;height:10px;border-radius:999px;background:var(--ok)}
    .footer{
      margin-top:16px;color:rgba(255,255,255,.45);font-size:12px;text-align:center
    }

    /* Honeypot anti-spam */
    .hp{position:absolute;left:-9999px;opacity:0;height:0;width:0}
  </style>
</head>

<body>
  <div class="wrap">

    <div class="topbar">
      <div class="brand">
        <div class="logo">PA</div>
        <div>
          <h1>PHOENIX AUTOMOBILE</h1>
          <small>Vente rapide, sécurisée et au meilleur prix.</small>
        </div>
      </div>

      <div class="ctaRow">
        <button class="btn" id="btnScroll">Ouvrir le formulaire</button>
        <a class="btn primary" href="https://wa.me/33663620397" target="_blank" rel="noopener">WhatsApp — Estimation</a>
      </div>
    </div>

    <div class="hero">
      <div class="card heroLeft">
        <div class="kicker">Saint-Brieuc / Côtes-d’Armor</div>
        <h2 class="headline">Acheter ou vendre un véhicule, <span>sans perte de temps.</span></h2>
        <p class="sub">Tu remplis 3 étapes, je te recontacte rapidement avec une proposition de rendez-vous. Simple, propre, efficace.</p>

        <div class="badges">
          <div class="badge">✅ Acheteurs filtrés</div>
          <div class="badge">✅ Accompagnement administratif</div>
          <div class="badge">✅ Transaction sécurisée</div>
          <div class="badge">✅ Réponse rapide</div>
        </div>
      </div>

      <div class="card heroRight" id="formCard">
        <div class="panelHead">
          <p class="panelTitle">Formulaire — Estimation / Contact</p>
          <p class="panelNote">3 étapes. 60 secondes. Derrière, Phoenix Automobile te recontacte.</p>
        </div>

        <div class="formWrap">
          <div class="progress">
            <div class="bar" aria-label="progression"><i id="barFill"></i></div>
            <div id="stepText" class="stepText">1/3</div>
          </div>

          <form id="phoenixForm" novalidate>
            <!-- Honeypot anti-spam -->
            <input class="hp" type="text" name="company" id="company" autocomplete="off" tabindex="-1" />

            <!-- STEP 1 -->
            <section id="step1">
              <label>1 — Vous souhaitez :</label>
              <div class="radioRow" role="group" aria-label="Acheter ou vendre">
                <label class="chip" id="chipAcheter">
                  <input type="radio" name="typeDemande" value="Acheter" required>
                  Acheter un véhicule
                </label>
                <label class="chip" id="chipVendre">
                  <input type="radio" name="typeDemande" value="Vendre" required>
                  Vendre un véhicule
                </label>
              </div>
              <p class="muted" style="margin:12px 0 0;">Tu choisis une option, puis “Suivant”.</p>
            </section>

            <!-- STEP 2 -->
            <section id="step2" class="hide">
              <label>2 — Infos véhicule</label>
              <div class="grid">
                <div>
                  <label for="modele">Modèle du véhicule</label>
                  <input id="modele" name="modele" placeholder="Ex: Peugeot 208, BMW Série 3..." required />
                </div>
                <div>
                  <label for="annee">Année</label>
                  <input id="annee" name="annee" placeholder="Ex: 2019" inputmode="numeric" required />
                </div>
              </div>
              <p class="muted" style="margin:12px 0 0;">Tu peux être simple. On affine ensuite.</p>
            </section>

            <!-- STEP 3 -->
            <section id="step3" class="hide">
              <label>3 — Infos client</label>
              <div class="grid">
                <div>
                  <label for="nom">Nom</label>
                  <input id="nom" name="nom" placeholder="Nom" required />
                </div>
                <div>
                  <label for="prenom">Prénom</label>
                  <input id="prenom" name="prenom" placeholder="Prénom" required />
                </div>
                <div>
                  <label for="cp">Code postal</label>
                  <input id="cp" name="cp" placeholder="Ex: 22000" inputmode="numeric" required />
                </div>
                <div>
                  <label for="ville">Ville</label>
                  <input id="ville" name="ville" placeholder="Ex: Saint-Brieuc" required />
                </div>
                <div>
                  <label for="contact">Contact (numéro ou email)</label>
                  <input id="contact" name="contact" placeholder="06.. ou email" required />
                </div>
                <div>
                  <label for="creneau">Créneau de rappel souhaité</label>
                  <input id="creneau" name="creneau" placeholder="Ex: mardi après-midi" required />
                </div>
              </div>

              <div style="margin-top:12px;">
                <label for="details">Détails (optionnel)</label>
                <textarea id="details" name="details" placeholder="Ex: kilométrage, budget, urgence, infos utiles..."></textarea>
              </div>

              <p class="muted" style="margin:12px 0 0;">
                En envoyant, tu acceptes d’être recontacté par Phoenix Automobile.
              </p>
            </section>

            <div class="actions">
              <button type="button" class="btn" id="prevBtn">Retour</button>
              <button type="button" class="btn primary" id="nextBtn">Suivant</button>
            </div>

            <p id="status" class="muted" style="margin-top:10px;"></p>
          </form>
        </div>
      </div>
    </div>

    <div class="footer">
      © Phoenix Automobile — Intermédiation entre particuliers.
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modalCard">
      <h3>Demande envoyée ✅</h3>
      <p class="muted" style="margin:0;">
        Phoenix Automobile vous enverra un message pour vous proposer un rendez-vous dans les plus brefs délais.
      </p>
      <div class="okLine"><span class="okDot"></span> Merci, à très vite.</div>
      <div style="display:flex;justify-content:flex-end;margin-top:14px;">
        <button class="btn primary" id="closeModal">Fermer</button>
      </div>
    </div>
  </div>

  <script>
    // ⚠️ Mets ici l’URL du Web App Google Apps Script (je te donne le code plus bas)
    const APPS_SCRIPT_URL = "COLLE_ICI_TON_URL_APPS_SCRIPT";

    const form = document.getElementById("phoenixForm");
    const statusEl = document.getElementById("status");
    const btnScroll = document.getElementById("btnScroll");

    const step1 = document.getElementById("step1");
    const step2 = document.getElementById("step2");
    const step3 = document.getElementById("step3");

    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    const barFill = document.getElementById("barFill");
    const stepText = document.getElementById("stepText");

    const modal = document.getElementById("modal");
    const closeModal = document.getElementById("closeModal");

    let step = 1;

    function setStep(n){
      step = n;

      step1.classList.toggle("hide", step !== 1);
      step2.classList.toggle("hide", step !== 2);
      step3.classList.toggle("hide", step !== 3);

      prevBtn.style.visibility = (step === 1) ? "hidden" : "visible";

      if(step < 3){
        nextBtn.textContent = "Suivant";
        nextBtn.disabled = false;
      }else{
        nextBtn.textContent = "Envoyer";
        nextBtn.disabled = false;
      }

      const pct = (step - 1) / 3 * 100; // 0, 33, 66
      barFill.style.width = (step === 1 ? 33 : step === 2 ? 66 : 100) + "%";

      if(step === 3){
        stepText.textContent = "3/3";
      }else{
        stepText.textContent = `${step}/3`;
      }
      stepText.classList.remove("ok");
      statusEl.textContent = "";
    }

    function validateStep(n){
      // validation minimaliste, efficace
      if(n === 1){
        const choice = form.querySelector('input[name="typeDemande"]:checked');
        if(!choice){
          statusEl.textContent = "Choisis “Acheter” ou “Vendre”.";
          return false;
        }
        return true;
      }
      if(n === 2){
        const modele = form.modele.value.trim();
        const annee = form.annee.value.trim();
        if(!modele || !annee){
          statusEl.textContent = "Remplis le modèle et l’année.";
          return false;
        }
        if(!/^\d{4}$/.test(annee)){
          statusEl.textContent = "Année invalide (ex: 2018).";
          return false;
        }
        return true;
      }
      if(n === 3){
        const required = ["nom","prenom","cp","ville","contact","creneau"];
        for(const k of required){
          if(!form[k].value.trim()){
            statusEl.textContent = "Remplis tous les champs obligatoires.";
            return false;
          }
        }
        return true;
      }
      return true;
    }

    async function submitForm(){
      if(APPS_SCRIPT_URL.includes("COLLE_ICI")){
        statusEl.textContent = "⚠️ Tu n’as pas encore collé l’URL Apps Script dans le code.";
        return;
      }

      // honeypot anti-spam
      if(form.company.value.trim().length > 0){
        // bot -> on fait comme si c’était ok, mais on n’envoie rien
        openModal(true);
        return;
      }

      nextBtn.disabled = true;
      statusEl.textContent = "Envoi en cours…";

      const payload = {
        typeDemande: form.typeDemande.value,
        modele: form.modele.value.trim(),
        annee: form.annee.value.trim(),
        nom: form.nom.value.trim(),
        prenom: form.prenom.value.trim(),
        cp: form.cp.value.trim(),
        ville: form.ville.value.trim(),
        contact: form.contact.value.trim(),
        creneau: form.creneau.value.trim(),
        details: form.details.value.trim(),
        source: window.location.href,
        ts: new Date().toISOString()
      };

      try{
        const res = await fetch(APPS_SCRIPT_URL, {
          method: "POST",
          headers: {"Content-Type":"text/plain;charset=utf-8"},
          body: JSON.stringify(payload)
        });
        const data = await res.json().catch(()=>({ok:false}));

        if(!res.ok || !data.ok){
          throw new Error(data.error || "Erreur lors de l’envoi.");
        }

        stepText.textContent = "3/3 ✅";
        stepText.classList.add("ok");
        statusEl.textContent = "";
        openModal();
        form.reset();
        setStep(1);
      }catch(err){
        statusEl.textContent = "Erreur: " + (err.message || "Impossible d’envoyer.");
      }finally{
        nextBtn.disabled = false;
      }
    }

    function openModal(fake=false){
      modal.classList.add("open");
    }

    btnScroll.addEventListener("click", () => {
      document.getElementById("formCard").scrollIntoView({behavior:"smooth", block:"start"});
    });

    closeModal.addEventListener("click", () => modal.classList.remove("open"));
    modal.addEventListener("click", (e) => { if(e.target === modal) modal.classList.remove("open"); });

    prevBtn.addEventListener("click", () => setStep(Math.max(1, step-1)));

    nextBtn.addEventListener("click", async () => {
      if(!validateStep(step)) return;

      if(step < 3){
        setStep(step+1);
      }else{
        // step 3 -> send
        if(!validateStep(3)) return;
        await submitForm();
      }
    });

    // chips active style
    const chipAcheter = document.getElementById("chipAcheter");
    const chipVendre = document.getElementById("chipVendre");
    form.addEventListener("change", (e) => {
      if(e.target.name === "typeDemande"){
        chipAcheter.classList.toggle("active", e.target.value === "Acheter");
        chipVendre.classList.toggle("active", e.target.value === "Vendre");
      }
    });

    setStep(1);
  </script>
</body>
</html>
