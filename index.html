<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Phoenix Automobile</title>

<style>
body{
font-family: Arial, sans-serif;
margin:0;
background:#0f172a;
color:#fff;
}
.container{max-width:520px;margin:auto;padding:20px;}
.logo{width:120px;display:block;margin:20px auto;}
.card{
background:rgba(255,255,255,0.06);
border-radius:20px;
padding:20px;
backdrop-filter:blur(12px);
border:1px solid rgba(255,255,255,0.08);
}
h1{font-size:20px;text-align:center;margin:8px 0 16px;}
label{display:block;margin:10px 0;}
input, select{
width:100%;
padding:12px;
margin:8px 0;
border-radius:12px;
border:none;
font-size:16px;
outline:none;
}
.row{display:flex;gap:10px;}
.row > div{flex:1;}
.hint{font-size:12px;opacity:.8;margin-top:6px;}
.error{
background:rgba(240,141,52,0.18);
border:1px solid rgba(240,141,52,0.45);
color:#fff;
padding:10px 12px;
border-radius:12px;
margin:10px 0;
display:none;
}
button{
width:100%;
padding:14px;
border:none;
border-radius:14px;
font-size:16px;
margin-top:10px;
cursor:pointer;
background:#F08D34;
color:#111;
font-weight:700;
}
button.secondary{
background:transparent;
color:#fff;
border:1px solid rgba(255,255,255,0.2);
font-weight:600;
}
.progress{
height:8px;
background:#334155;
border-radius:10px;
overflow:hidden;
margin:10px 0 18px;
}
.bar{
height:100%;
background:#F08D34;
width:33%;
transition:0.3s;
}
.success{text-align:center;font-size:18px;line-height:1.35;}
</style>
</head>

<body>
<div class="container">
<img src="assets/logo.png" class="logo" alt="Phoenix Automobile" />

<div class="card">
<div class="progress"><div class="bar" id="bar"></div></div>

<div id="globalError" class="error"></div>

<!-- STEP 1 -->
<div id="step1">
<h1>1) Acheter ou vendre un véhicule ?</h1>

<div class="hint">Choisissez une option.</div>

<label><input type="radio" name="type" value="acheter"> Acheter</label>
<label><input type="radio" name="type" value="vendre"> Vendre</label>

<button type="button" onclick="next1()">Continuer</button>
<button type="button" class="secondary" onclick="resetAll()">Réinitialiser</button>
</div>

<!-- STEP 2 -->
<div id="step2" style="display:none">
<h1 id="title2"></h1>

<div id="acheter" style="display:none">
<div class="hint">Informations pour comprendre votre besoin</div>
<input id="marqueRecherche" placeholder="Marque souhaitée" autocomplete="off">
<input id="anneeRecherche" placeholder="Tranche d’année souhaitée" autocomplete="off">
<input id="budget" placeholder="Budget" autocomplete="off">
</div>

<div id="vendre" style="display:none">
<div class="hint">Informations sur votre véhicule</div>
<input id="modele" placeholder="Marque et modèle du véhicule" autocomplete="off">
<input id="annee" placeholder="Année du véhicule" autocomplete="off">
<input id="prix" placeholder="Tranche de prix souhaitée" autocomplete="off">
</div>

<button type="button" onclick="next2()">Continuer</button>
<button type="button" class="secondary" onclick="backTo1()">Retour</button>
</div>

<!-- STEP 3 -->
<div id="step3" style="display:none">
<h1>3) Informations client</h1>

<input id="nom" placeholder="Nom" autocomplete="family-name">
<input id="prenom" placeholder="Prénom" autocomplete="given-name">
<input id="cp" placeholder="Code postal" inputmode="numeric" autocomplete="postal-code">
<input id="ville" placeholder="Ville" autocomplete="address-level2">

<div class="row">
<div>
<input id="tel" placeholder="Numéro (ex : 06 12 34 56 78)" inputmode="tel" autocomplete="tel">
</div>
<div>
<input id="email" placeholder="Email (optionnel)" inputmode="email" autocomplete="email">
</div>
</div>
<div class="hint">Au moins un des deux champs (numéro ou email) doit être renseigné.</div>

<input id="creneau" placeholder="Créneau souhaité pour être rappelé (ex : mardi après-midi)" autocomplete="off">

<button type="button" onclick="send()">Envoyer</button>
<button type="button" class="secondary" onclick="backTo2()">Retour</button>
</div>

<!-- DONE -->
<div id="done" style="display:none" class="success">
✅ Le formulaire a été envoyé.<br><br>
Phoenix Automobile vous recontactera rapidement.<br>
<strong>Merci de votre confiance !</strong>
<br><br>
<button type="button" onclick="location.reload()">Menu principal</button>
</div>

</div>
</div>

<script>
const ENDPOINT = "https://script.google.com/macros/s/AKfycby8XrrhPsyJR_1IKZ53u6K8cc0jPSPyvvAQAElHMYuShJhKaRtiR3ETY8CNy-HAi_VH/exec";
let data = {};

function showError(msg){
const box = document.getElementById("globalError");
box.style.display = "block";
box.textContent = msg;
}
function clearError(){
const box = document.getElementById("globalError");
box.style.display = "none";
box.textContent = "";
}

function resetAll(){ location.reload(); }

function backTo1(){
clearError();
document.getElementById("step2").style.display="none";
document.getElementById("step1").style.display="block";
document.getElementById("bar").style.width="33%";
}

function backTo2(){
clearError();
document.getElementById("step3").style.display="none";
document.getElementById("step2").style.display="block";
document.getElementById("bar").style.width="66%";
}

function next1(){
clearError();
const picked = document.querySelector('input[name="type"]:checked');
if(!picked){
showError("Veuillez choisir une option (acheter ou vendre).");
return;
}

data = {};
data.type = picked.value;

document.getElementById("step1").style.display="none";
document.getElementById("step2").style.display="block";
document.getElementById("bar").style.width="66%";

document.getElementById("acheter").style.display = (data.type==="acheter") ? "block" : "none";
document.getElementById("vendre").style.display = (data.type==="vendre") ? "block" : "none";

document.getElementById("title2").innerText =
(data.type==="acheter") ? "2) Informations pour comprendre votre besoin" : "2) Informations sur votre véhicule";
}

function next2(){
clearError();

if(data.type==="acheter"){
data.marqueRecherche = (document.getElementById("marqueRecherche").value || "").trim();
data.anneeRecherche = (document.getElementById("anneeRecherche").value || "").trim();
data.budget = (document.getElementById("budget").value || "").trim();

// pas de validation “agressive” ici : tu peux rendre obligatoire si tu veux
} else {
data.modele = (document.getElementById("modele").value || "").trim();
data.annee = (document.getElementById("annee").value || "").trim();
data.prix = (document.getElementById("prix").value || "").trim();
}

document.getElementById("step2").style.display="none";
document.getElementById("step3").style.display="block";
document.getElementById("bar").style.width="100%";
}

function send(){
clearError();

data.nom = (document.getElementById("nom").value || "").trim();
data.prenom = (document.getElementById("prenom").value || "").trim();
data.cp = (document.getElementById("cp").value || "").trim();
data.ville = (document.getElementById("ville").value || "").trim();
data.tel = (document.getElementById("tel").value || "").trim();
data.email = (document.getElementById("email").value || "").trim();
data.creneau= (document.getElementById("creneau").value || "").trim();

// Validation : au moins tel ou email
if(!data.tel && !data.email){
showError("Veuillez renseigner au moins un numéro ou un email.");
return;
}

// Validation minimale du reste (tu peux assouplir si besoin)
if(!data.nom || !data.prenom || !data.cp || !data.ville || !data.creneau){
showError("Veuillez compléter les informations client (nom, prénom, code postal, ville, créneau).");
return;
}

fetch(ENDPOINT, {
method:"POST",
headers:{ "Content-Type":"text/plain;charset=utf-8" },
body: JSON.stringify(data)
}).catch(()=>{ /* on ne bloque pas l’UX */ });

document.getElementById("step3").style.display="none";
document.getElementById("done").style.display="block";
}
</script>

</body>
</html>
